# Руководство пользователя — XML Редактор Яндекс.Врачи

## Что это такое

Этот инструмент позволяет создавать и редактировать XML-фиды для размещения информации о врачах в сервисе **Яндекс.Врачи**. Вместо ручного редактирования XML-файла вы работаете с удобными формами, а готовый файл в нужном формате скачивается одной кнопкой.

---

## Первый вход

При первом открытии сайта вы попадёте на страницу настройки — **придумайте и введите пароль**. Этот же пароль потребуется при каждом входе.

> **Запомните пароль!** Он хранится в зашифрованном виде, восстановить его невозможно — только сбросить (см. раздел «Смена пароля»).

---

## Вход и выход

- **Вход:** откройте `/login.php`, введите пароль
- **Выход:** кнопка «Выход» в правом верхнем углу любой страницы
- Сессия сохраняется в браузере. Если долго не было активности — придётся войти заново

---

## Проекты

Каждый проект — это отдельный XML-фид одной клиники (или группы клиник). Проекты полностью изолированы друг от друга.

### Создать новый проект

1. На главной странице нажмите **«+ Новый проект»**
2. Введите короткое название — только латинские буквы, цифры, дефис или подчёркивание (например: `myclinic`, `clinic-moscow`)
3. Нажмите **«Создать»**

### Дашборд проекта

После выбора проекта открывается дашборд — счётчики сущностей (врачи, клиники, услуги, офферы) и форма метаданных. Заполните метаданные — они попадают в корневой элемент XML:

| Поле | Описание |
|------|----------|
| Название | Название организации (`<name>`) |
| Компания | Юридическое название (`<company>`) |
| URL сайта | Главная страница клиники |
| Email | Общий email |
| URL логотипа | Прямая ссылка на изображение |

---

## Импорт XML

Если у вас уже есть готовый XML-файл от Яндекса — загрузите его, чтобы не вводить данные вручную.

1. В боковом меню нажмите **«Импорт XML»**
2. Выберите XML-файл (кнопка «Выбрать файл»)
3. Нажмите **«Импортировать»**

Все данные из файла (врачи, клиники, услуги, офферы) будут загружены в базу. Если запись с таким же ID уже существует — она будет обновлена.

> **Совет:** После импорта проверьте разделы — особенно образование и сертификаты врачей.

---

## Врачи

### Список врачей

В боковом меню → **«Врачи»**. Таблица со всеми врачами, кнопки редактирования и удаления.

### Добавить / редактировать врача

Нажмите **«+ Добавить врача»** или кнопку **✎** рядом с нужным врачом.

#### Основные данные

**ID врача** — уникальный идентификатор. Заполняется автоматически из фамилии (транслитерацией): введите фамилию в поле «Фамилия» — ID обновится сам. Можно скорректировать вручную. После сохранения изменить нельзя.

**ФИО** — полное ФИО в одном поле (например: `Тимченко Елена Анатольевна`). Используется как отображаемое имя.

**Имя / Фамилия / Отчество** — заполните все три поля отдельно. Яндекс использует их для поиска и фильтрации по имени.

**Стаж** — число полных лет практики.

**Начало карьеры** — дата в формате `ГГГГ-ММ-ДД` (например: `1996-01-01`).

**Учёная степень** — выберите из списка: `кандидат наук` или `доктор наук`.

**Звание** — `доцент` или `профессор`.

**Категория** — `первая`, `вторая` или `высшая`.

#### Образование, места работы, сертификаты

Эти разделы свёрнуты по умолчанию. Нажмите на заголовок чтобы раскрыть, или кнопку **«+ Добавить»** — секция раскроется автоматически.

В скобках рядом с заголовком показывается количество записей: `Образование (3)`.

**Образование:** укажите организацию, год окончания, тип (Специалитет / Ординатура / Аспирантура) и специализацию.

**Места работы:** организация, период (формат `2000-2010` или `2015-н.в.`), должность.

**Сертификаты:** название курса/сертификата, организация, год получения.

Удалить строку — кнопка **✕** справа.

#### Офферы врача

В нижней части страницы — таблица предложений этого врача. Здесь видно в каких клиниках и по каким услугам работает врач. Кнопка **«+ Добавить оффер»** открывает форму создания оффера с уже выбранным врачом.

---

## Клиники

В боковом меню → **«Клиники»**.

### Основные поля

| Поле | Формат | Пример |
|------|--------|--------|
| ID | Латиница, цифры, дефис | `clinic_1` |
| Название | Полное официальное | `Клиника Яндекс Здоровье` |
| Город | Только название | `Краснодар` |
| Адрес | Улица и дом | `ул. Красная, 1` |
| Телефон | `+7(000)000-00-00` | `+7(861)238-74-20` |
| Company ID | ID в Яндекс.Бизнес | Из URL: `yandex.ru/profile/XXXXXXX` |

---

## Услуги

В боковом меню → **«Услуги»**.

### Особое поле: Код услуги (gov_id)

Код из Номенклатуры медицинских услуг Министерства здравоохранения РФ. Формат: `A01.07.001` (буква, две цифры, точка, две цифры, точка, три цифры).

Найти код можно в приказе Минздрава России № 804н или в реестре услуг вашей МИС.

Это поле необязательное, но **рекомендуется заполнять** — Яндекс использует его для категоризации.

---

## Предложения (Офферы)

Оффер — это конкретное предложение: **врач X принимает в клинике Y по услуге Z**. Один врач может иметь несколько офферов (разные клиники или услуги).

### Как создать оффер

**Способ 1:** через карточку врача — кнопка «+ Добавить оффер» внизу страницы редактирования врача. Врач будет уже выбран автоматически.

**Способ 2:** через раздел «Предложения» в меню → «+ Добавить предложение».

### Автоматическое заполнение

- **ID оффера** генерируется автоматически при выборе врача и клиники: `фамилия_id_клиники` (например: `vinogradov_clinic_1`). Можно изменить вручную.
- **Клиника** — если в проекте только одна клиника, она подставляется автоматически.

### Флаги

| Флаг | Значение |
|------|---------|
| Запись (appointment) | Врач принимает запись. Снять если временно недоступен |
| Онлайн-расписание | Пользователь может видеть свободные слоты |
| ОМС | Приём по полису обязательного медстрахования |
| Взрослые | Врач принимает пациентов от 18 лет |
| Дети | Врач принимает пациентов до 18 лет |
| Вызов на дом | Врач выезжает к пациенту |
| Телемедицина | Дистанционные онлайн-консультации |
| Базовая услуга | Основная специализация врача (влияет на ранжирование) |

По умолчанию включены: Запись, Взрослые, Базовая услуга.

### Цена

- **Базовая цена** — стоимость приёма. Оставьте пустым если цена не публикуется
- **Скидка** — сумма скидки в той же валюте
- **Бесплатный приём** — текстовое описание условий: например `первичный осмотр бесплатно`. Заполняйте только если действительно есть бесплатный приём

---

## Специальности

В боковом меню → **«Специальности»**.

Список специальностей используется как подсказка в поле «Специальность» при создании оффера. При создании нового проекта список автоматически заполняется 28 специальностями (стоматологические + общие).

### Добавить специальность
Нажмите **«+ Добавить»**, введите название, укажите порядок сортировки (меньше = выше в списке).

### Удалить специальность
Кнопка удаления заблокирована если специальность используется хотя бы в одном оффере. Сначала измените специальность в офферах.

> **Совет:** Поле специальности в оффере — свободный текст. Можно ввести значение вручную, даже если его нет в списке.

---

## Экспорт XML

1. В боковом меню нажмите **«Экспорт XML»**
2. Нажмите кнопку **«Скачать XML»**
3. Браузер загрузит файл с именем `название-проекта-ГГГГ-ММ-ДД.xml`

Файл готов для загрузки в Яндекс.Вебмастер или передачи в Яндекс через API.

> После экспорта рекомендуется проверить файл через **валидатор Яндекса** (найдите актуальную ссылку в документации Яндекс.Вебмастер).

---

## Смена пароля

**Обычная смена** (когда помните текущий пароль):
1. Нажмите кнопку **«Пароль»** в верхней панели
2. Введите текущий пароль и новый пароль дважды
3. Нажмите «Сохранить»

**Сброс пароля** (если забыли):
1. Через FTP, SSH или файловый менеджер хостинга создайте пустой файл `data/.reset` в папке проекта
2. Откройте `/setup.php` в браузере
3. Введите новый пароль
4. Файл `.reset` удалится автоматически

---

## Частые вопросы

**Я загрузил XML, но образование врачей не отображается — это нормально?**
Нет. Если данные были в XML, они должны импортироваться. Зайдите в раздел «Врачи», откройте любого врача — раздел «Образование» должен быть раскрыт и содержать записи.

**Можно ли работать с несколькими проектами одновременно?**
Да. Откройте разные вкладки браузера с разными проектами — они не мешают друг другу.

**Что будет если дважды импортировать один и тот же файл?**
Данные обновятся, дубликатов не будет. Записи с одинаковыми ID перезапишутся.

**Могу ли я экспортировать XML и сразу импортировать его обратно?**
Да, формат импорта и экспорта совпадает.

**Куда отправлять готовый XML?**
Это зависит от ваших договорённостей с Яндексом. Обычно через Яндекс.Вебмастер или по прямому URL (если файл доступен онлайн). Уточните у вашего менеджера Яндекса.
